<section id="hero" class="hero-section">
    <img [src]="heroBuildingImage" alt="Pandigi Building" class="building-image"
        [@slideInRight]="buildingVisible ? 'visible' : 'hidden'">

    <nav class="navbar-floating" [@navbarSlide]="navbarVisible ? 'visible' : 'hidden'">
        <div class="navbar-container">
            <div class="navbar-logo">
                <img src="/content/logo-no-bg.webp" alt="Pandigi Logo" (click)="navigateToOtherPage('/')">
            </div>
            <ul class="navbar-menu">
                <li><a (click)="navigateToOtherPage('/what-we-do')">WHAT WE DO</a></li>
                <li><a (click)="navigateToOtherPage('/who-we-are')">WHO WE ARE</a></li>
                <li><a (click)="scrollToSection('hero')" class="active">OUR WORK</a></li>
                <li><a (click)="navigateToOtherPage('/build')">BUILD WITH US</a></li>
            </ul>
        </div>
    </nav>

    <div id="hero-text" class="hero-content">
        <h1 id="hero-title" class="hero-title" [@slideInLeft]="buildingVisible ? 'visible' : 'hidden'">{{ heroTitle }}
        </h1>
        <p class="hero-subtitle" [@slideInLeft]="buildingVisible ? 'visible' : 'hidden'">{{ heroSubtitle }}</p>
        <img [src]="heroVector" alt="Pandigi Logo" class="hero-logo" loading="lazy">
    </div>
</section>

<!-- Projects Section -->
<section id="projects" class="section projects-section" [@fadeInUp]="projectsVisible ? 'visible' : 'hidden'">
    <div class="full-container">
        
        <!-- White Container Wrapper -->
        <div class="projects-container">

            <!-- Featured Projects -->
            <div class="featured-section" *ngIf="!featuredLoading && featuredProjects.length > 0">
                <div class="featured-header">
                    <h2 class="featured-title">Featured Projects</h2>
                    <p class="featured-subtitle">Explore our highlighted work and success stories</p>
                </div>
                
                <div class="featured-grid">
                    <div class="featured-card" *ngFor="let project of featuredProjects.slice(0, 3)">
                        <div class="featured-image-wrapper">
                            <img 
                                *ngIf="project.projectImage" 
                                [src]="getImageUrl(project.projectImage)" 
                                [alt]="project.projectTitle"
                                class="featured-image"
                            >
                            <div *ngIf="!project.projectImage" class="featured-image-placeholder">
                                <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M53.33 50.67V18.67L37.33 10.67L10.67 18.67v32l26.66 8 16-8z" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M10.67 18.67l26.66 8m0 0l16-8m-16 8v32" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            
                            <div class="featured-badge">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 1l2.163 4.382 4.837.704-3.5 3.411.826 4.818L8 12.236l-4.326 2.079.826-4.818-3.5-3.41 4.837-.705L8 1z"/>
                                </svg>
                                Featured
                            </div>
                            
                            <div class="featured-overlay">
                                <span class="featured-category">{{ getCategoryName(project.projectCategory) }}</span>
                            </div>
                        </div>
                        
                        <div class="featured-content">
                            <h3 class="featured-project-title">{{ project.projectTitle }}</h3>
                            
                            <div class="featured-meta">
                                <span *ngIf="project.projectClient" class="meta-item">
                                    <svg class="meta-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="7" cy="4" r="2.5" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M2 12c0-2.761 2.239-5 5-5s5 2.239 5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    {{ project.projectClient }}
                                </span>
                                <span *ngIf="project.projectYear" class="meta-item">
                                    <svg class="meta-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M2 6h10M5 2v2M9 2v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    {{ project.projectYear }}
                                </span>
                            </div>
                            
                            <p class="featured-description" *ngIf="project.projectDescription">
                                {{ project.projectDescription.length > 120 ? (project.projectDescription | slice:0:120) + '...' : project.projectDescription }}
                            </p>
                            
                            <div class="featured-technologies" *ngIf="project.projectTechnologies && project.projectTechnologies.length > 0">
                                <span class="tech-tag" *ngFor="let tech of project.projectTechnologies.slice(0, 3)">
                                    {{ tech }}
                                </span>
                                <span class="tech-tag more" *ngIf="project.projectTechnologies.length > 3">
                                    +{{ project.projectTechnologies.length - 3 }}
                                </span>
                            </div>
                            
                            <a 
                                *ngIf="project.projectUrl" 
                                [href]="project.projectUrl" 
                                target="_blank"
                                class="featured-link"
                            >
                                View Project
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2 12L12 2M12 2H5M12 2v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="featured-divider"></div>
            </div>
            
            <!-- Search & Filter Container -->
            <div class="search-filter-container">
                <div class="search-wrapper">
                    <div class="search-input-group">
                        <input 
                            type="text" 
                            [(ngModel)]="searchQuery"
                            (keyup.enter)="onSearch()"
                            placeholder="Search projects by title, client, or description..."
                            class="search-input"
                        >
                        <button 
                            *ngIf="searchQuery" 
                            class="clear-search-btn"
                            (click)="clearSearch()"
                            title="Clear search"
                        >
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                        <button class="search-btn" (click)="onSearch()">
                            Search
                        </button>
                    </div>
                </div>
                
                <button class="filter-btn" (click)="toggleFilterModal()">
                    <svg class="filter-icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 4h12M4 8h8M6 12h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Filter
                    <span *ngIf="activeFiltersCount > 0" class="filter-badge">{{ activeFiltersCount }}</span>
                </button>
            </div>

            <!-- Active Filters Display -->
            <div class="active-filters" *ngIf="selectedCategory || selectedYear">
                <span class="filter-label">Active Filters:</span>
                
                <span class="filter-tag" *ngIf="selectedCategory">
                    {{ getCategoryName(selectedCategory) }}
                    <button class="remove-filter" (click)="selectedCategory = null; applyFilters()">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </button>
                </span>
                
                <span class="filter-tag" *ngIf="selectedYear">
                    {{ selectedYear }}
                    <button class="remove-filter" (click)="selectedYear = null; applyFilters()">
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </button>
                </span>
                
                <button class="clear-all-filters" (click)="clearFilters()">Clear All</button>
            </div>

            <!-- Loading State -->
            <div class="loading-state" *ngIf="loading">
                <div class="spinner"></div>
                <p>Loading projects...</p>
            </div>

            <!-- Projects Grid -->
            <div class="projects-grid" *ngIf="!loading && projects.length > 0">
                <div class="project-card" *ngFor="let project of projects">
                    <div class="project-image-wrapper">
                        <img 
                            *ngIf="project.projectImage" 
                            [src]="getImageUrl(project.projectImage)" 
                            [alt]="project.projectTitle"
                            class="project-image"
                        >
                        <div *ngIf="!project.projectImage" class="project-image-placeholder">
                            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M40 38V14L28 8L8 14v24l20 6 12-6z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 14l20 6m0 0l12-6m-12 6v24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        
                        <div class="project-overlay">
                            <span class="project-category">{{ getCategoryName(project.projectCategory) }}</span>
                        </div>
                    </div>
                    
                    <div class="project-content">
                        <h3 class="project-title">{{ project.projectTitle }}</h3>
                        
                        <div class="project-meta">
                            <span *ngIf="project.projectClient" class="meta-item">
                                <svg class="meta-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="7" cy="4" r="2.5" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M2 12c0-2.761 2.239-5 5-5s5 2.239 5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                {{ project.projectClient }}
                            </span>
                            <span *ngIf="project.projectYear" class="meta-item">
                                <svg class="meta-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="2" y="3" width="10" height="9" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M2 6h10M5 2v2M9 2v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                {{ project.projectYear }}
                            </span>
                        </div>
                        
                        <p class="project-description" *ngIf="project.projectDescription">
                            {{ project.projectDescription.length > 150 ? (project.projectDescription | slice:0:150) + '...' : project.projectDescription }}
                        </p>
                        
                        <div class="project-technologies" *ngIf="project.projectTechnologies && project.projectTechnologies.length > 0">
                            <span class="tech-tag" *ngFor="let tech of project.projectTechnologies.slice(0, 4)">
                                {{ tech }}
                            </span>
                            <span class="tech-tag more" *ngIf="project.projectTechnologies.length > 4">
                                +{{ project.projectTechnologies.length - 4 }}
                            </span>
                        </div>
                        
                        <div class="project-spacer" *ngIf="!project.projectTechnologies || project.projectTechnologies.length === 0"></div>
                        
                        <a 
                            *ngIf="project.projectUrl" 
                            [href]="project.projectUrl" 
                            target="_blank"
                            class="project-link"
                        >
                            View Project
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M2 10L10 2M10 2H4M10 2v6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" *ngIf="!loading && projects.length === 0">
                <svg class="empty-icon" width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="26" cy="26" r="14" stroke="currentColor" stroke-width="3"/>
                    <path d="M37 37l10 10" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                </svg>
                <h3>No Projects Found</h3>
                <p>Try adjusting your search or filters to find what you're looking for.</p>
                <button class="reset-btn" (click)="clearFilters(); clearSearch()">Reset All</button>
            </div>

            <!-- Pagination -->
            <div class="pagination" *ngIf="!loading && totalPages > 1">
                <button 
                    class="pagination-btn" 
                    [disabled]="!hasPrevious"
                    (click)="previousPage()"
                >
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Previous
                </button>
                
                <div class="pagination-pages">
                    <button 
                        *ngFor="let page of [].constructor(totalPages); let i = index"
                        class="page-btn"
                        [class.active]="i === currentPage"
                        (click)="goToPage(i)"
                    >
                        {{ i + 1 }}
                    </button>
                </div>
                
                <button 
                    class="pagination-btn" 
                    [disabled]="!hasNext"
                    (click)="nextPage()"
                >
                    Next
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>

            <div class="pagination-info" *ngIf="!loading && projects.length > 0">
                Showing {{ (currentPage * pageSize) + 1 }} - {{ Math.min((currentPage + 1) * pageSize, totalItems) }} of {{ totalItems }} projects
            </div>

        </div>
        <!-- End White Container Wrapper -->

    </div>
</section>

<!-- Filter Modal -->
<div class="modal-overlay" *ngIf="showFilterModal" (click)="toggleFilterModal()">
    <div class="filter-modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>Filter Projects</h2>
            <button class="close-btn" (click)="toggleFilterModal()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 5L5 15M5 5l10 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        
        <div class="modal-body">
            <!-- Category Filter -->
            <div class="filter-group">
                <label>Category</label>
                <div class="custom-dropdown" (click)="$event.stopPropagation()">
                    <div
                        class="custom-dropdown-trigger"
                        [class.active]="dropdownStates['category']"
                        (click)="toggleDropdown('category', $event)"
                    >
                        <span class="custom-dropdown-label">
                            {{ selectedCategory ? getCategoryName(selectedCategory) : 'All Categories' }}
                        </span>

                        <span class="custom-dropdown-arrow" [class.rotated]="dropdownStates['category']">
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M6 9L1 4h10z" fill="currentColor"/>
                            </svg>
                        </span>
                    </div>

                    <div class="custom-dropdown-menu" [class.show]="dropdownStates['category']">
                        <div
                            class="custom-dropdown-item"
                            [class.selected]="selectedCategory === null"
                            (click)="selectCategory(null)"
                        >
                            All Categories
                        </div>
                        <div
                            class="custom-dropdown-item"
                            *ngFor="let cat of filterOptions.categories"
                            [class.selected]="cat.value === selectedCategory"
                            (click)="selectCategory(cat.value)"
                        >
                            {{ cat.label }}
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Year Filter -->
            <div class="filter-group">
                <label>Year</label>
                <div class="custom-dropdown" (click)="$event.stopPropagation()">
                    <div
                        class="custom-dropdown-trigger"
                        [class.active]="dropdownStates['year']"
                        (click)="toggleDropdown('year', $event)"
                    >
                        <span class="custom-dropdown-label">
                            {{ selectedYear ? selectedYear : 'All Years' }}
                        </span>

                        <span class="custom-dropdown-arrow" [class.rotated]="dropdownStates['year']">
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M6 9L1 4h10z" fill="currentColor"/>
                            </svg>
                        </span>
                    </div>

                    <div class="custom-dropdown-menu" [class.show]="dropdownStates['year']">
                        <div
                            class="custom-dropdown-item"
                            [class.selected]="selectedYear === null"
                            (click)="selectYear(null)"
                        >
                            All Years
                        </div>
                        <div
                            class="custom-dropdown-item"
                            *ngFor="let year of filterOptions.years"
                            [class.selected]="year === selectedYear"
                            (click)="selectYear(year)"
                        >
                            {{ year }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn-secondary" (click)="clearFilters()">Clear All</button>
            <button class="btn-primary" (click)="applyFilters()">Apply Filters</button>
        </div>
    </div>
</div>

<!-- Footer Section -->
<footer class="footer-section">
  <div class="footer-container">
    <div class="footer-info">
      <p class="footer-line">{{ footerAddressLine1 }}</p>
      <p class="footer-line">{{ footerAddressLine2 }}</p>
      <p class="footer-line">{{ footerAddressLine3 }}</p>
    </div>
    <div class="footer-bottom">
      <div class="footer-logo">
        <img src="/content/logo-no-bg.png" alt="Pandigi Logo">
      </div>
      <div class="footer-copyright">
        <p>{{ footerCopyright }}</p>
      </div>
    </div>
  </div>
</footer>